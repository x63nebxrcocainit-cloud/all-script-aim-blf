local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/land9678/Sapi-Hub-V1/refs/heads/main/KavoUI.txt"))()
local AimlockModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/jaanu91/Ip/refs/heads/main/Dk"))()
local ESPModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/jaanu91/Ip/refs/heads/main/Gk"))()
local SilentAimModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/jaanu91/Ip/refs/heads/main/Bg"))()
local StuffsModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/jaanu91/Ip/refs/heads/main/Stuf"))()
local OthersStuffsModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/jaanu91/Ip/refs/heads/main/Mot"))()
local UiSettingsModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/jaanu91/Ip/refs/heads/main/Vot"))()
local ZSkillModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/jaanu91/Ip/refs/heads/main/Teku"))()
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")  
local TeleportService = game:GetService("TeleportService")
local PlayerList = {"None"}

local toggleGui = Instance.new("ScreenGui")
toggleGui.Name = "ToggleGui"
toggleGui.Parent = game.CoreGui

local toggleButton = Instance.new("ImageButton")
toggleButton.Name = "SHV1"
toggleButton.Size = UDim2.new(0, 40, 0, 40)
toggleButton.Position = UDim2.new(0, 5, 0, 10)
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
toggleButton.BackgroundTransparency = 0.2
toggleButton.BorderSizePixel = 0
toggleButton.ZIndex = 9999
toggleButton.Image = "rbxassetid://76926193047725"
toggleButton.Parent = toggleGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 8)
toggleCorner.Parent = toggleButton

UiSettingsModule:MakeDraggable(toggleButton)

local Settings = OthersStuffsModule.LoadSettings()

local executor = "Unknown"
if syn then
    executor = "Synapse X"
elseif KRNL_LOADED then
    executor = "KRNL"
elseif fluxus then
    executor = "Fluxus"
elseif getexecutorname then
    local success, execName = pcall(getexecutorname)
    if success and type(execName) == "string" then
        executor = execName
    end
end

local execStatus = (executor == "Xeno" or executor:lower():find("solara") or executor:lower():find("krnl")) and "Not Working" or "Working"

local Window = Library.CreateLib("Sapi Hub BF PvP ÀÉ·¥óÀÇ  |  " .. executor, UiSettingsModule.currentTheme)

local Tab = Window:NewTab("‚óá„ÉªExecutor Status")
local Section = Tab:NewSection("‚óà„ÉªInformation")

Section:NewLabel("Executor: " .. executor)
Section:NewLabel("Status: " .. execStatus)

local Tab = Window:NewTab("‚õì„ÉªChangesLogs")
local Section = Tab:NewSection("‚úè„ÉªUpdated")

Section:NewLabel("‚Ä¢ Fixed Dropdown Save Settings ‚úî")
Section:NewLabel("‚Ä¢ Added Info Of Target (Name/Health) ‚úî")
Section:NewLabel("‚Ä¢ Optimized Script ‚úî")
Section:NewLabel("‚Ä¢ Improved Fps Boost ‚úî")
Section:NewLabel("‚Ä¢ Fixed Soul Guitar M1in Silent aim ‚úî")
Section:NewLabel("‚Ä¢ Added RTX Graphic(Visual Vibes) ‚úî")
Section:NewLabel("‚Ä¢ Added Custom Global Text ‚úî")
Section:NewLabel("‚Ä¢ Added Dash No CD ‚úî")
Section:NewLabel("‚Ä¢ Added Remove Fog or Lava ‚úî")
Section:NewLabel("‚Ä¢ Added Z Skills Work(Except Godhuman Z) ‚úî")
Section:NewLabel("‚Ä¢ Added Fruit M1 Closet Attack ‚úî")
Section:NewLabel("‚Ä¢ Fixed Buddy Sword X in Silent aim ‚úî")

local Tab = Window:NewTab("‚ùñ„ÉªAimbot")
local Section = Tab:NewSection("‚òò„ÉªSettings")

local AimlockPlayersToggle = Section:NewToggle("„ÉªAimlock Players", "Lock onto nearest player", function(state)
    AimlockModule:SetPlayerAimlock(state)
    Settings["AimlockPlayers"] = state
end)

local AimlockPlayersMiniTogglePlayersToggle = Section:NewToggle("„ÉªAimlock Mini Toggle Players", "Lock onto nearest player", function(state)
    AimlockModule:SetMiniTogglePlayerAimlock(state)
    Settings["AimlockPlayersMiniTogglePlayers"] = state
end)

local AimlockNPCToggle = Section:NewToggle("„ÉªAimlock NPC", "Lock onto nearest NPC/Boss", function(state)
    AimlockModule:SetNpcAimlock(state)
    Settings["AimlockNPC"] = state
end)

local AimlockPlayersMiniToggleNPCToggle = Section:NewToggle("„ÉªAimlock Mini Toggle NPC", "Lock onto nearest NPC/Boss", function(state)
    AimlockModule:SetMiniToggleNpcAimlock(state)
    Settings["AimlockPlayersMiniToggleNPC"] = state
end)

local PredictionToggle = Section:NewToggle("„ÉªPrediction", "Predict enemy movement", function(state)
    AimlockModule:SetPrediction(state)
    Settings["Prediction"] = state
end)

local PredictionAimlockAmountDropdown = Section:NewDropdown("„ÉªPrediction Amount | Default 0.1s", "Select max Prediction for Aimlock", {"0.2", "0.3", "0.4"}, function(selected)
    local num = tonumber(selected)
    if num then
        AimlockModule:SetPredictionTime(num)
        Settings["PredictionAmount"] = num
    end
end)

local Tab = Window:NewTab("‚õ©„ÉªSilent Aimbot")
local Section = Tab:NewSection("‚öì„ÉªSettings")

local SilentAimPlayersToggle = Section:NewToggle("„ÉªSilentAim Players", "Lock onto nearest player", function(state)
    SilentAimModule:SetPlayerSilentAim(state)
    Settings["SilentAimPlayers"] = state
end)

local SilentMiniTogglePlayersToggle = Section:NewToggle("„ÉªSilentAim Mini Toggle Players", "Lock onto nearest player", function(state)
    SilentAimModule:SetMiniTogglePlayerSilentAim(state)
    Settings["SilentMiniTogglePlayers"] = state
end)

local SilentAimNPCToggle = Section:NewToggle("„ÉªSilentAim Npcs", "Lock onto nearest npc", function(state)
    SilentAimModule:SetNPCSilentAim(state)
    Settings["SilentAimNPC"] = state
end)

local SilentMiniToggleNPCToggle = Section:NewToggle("„ÉªSilentAim Mini Toggle NPC", "Lock onto nearest NPC/Boss", function(state)
    SilentAimModule:SetMiniToggleNpcSilentAim(state)
    Settings["SilentMiniToggleNPC"] = state
end)

local SilentAimPedictionToggle = Section:NewToggle("„ÉªSilentAim Prediction", "Prediction on target", function(state)
    SilentAimModule:SetPrediction(state)
    Settings["SilentAimPediction"] = state
end)

local PredictionAmountDropdown = Section:NewDropdown("„ÉªPrediction Future | Default 0.1s", "Select max Prediction for Silent Aim", {"0.2", "0.3", "0.4"}, function(selected)
    local num = tonumber(selected)
    if num then
        SilentAimModule:SetPredictionAmount(num)
        Settings["SilentAimPredictionFuture"] = num
    end
end)

local DistanceAmountDropdown = Section:NewDropdown("„ÉªDistance Limit | Default 1000m", "Select max distance for aimbot", {"200", "400", "600"}, function(selected)
    local num = tonumber(selected)
    if num then
        SilentAimModule:SetDistanceLimit(num)
        Settings["SilentAimDistanceLimit"] = num
    end
end)

for _, plr in ipairs(Players:GetPlayers()) do
    if plr ~= Players.LocalPlayer then
        table.insert(PlayerList, plr.Name)
    end
end

local PlayerDropdown = Section:NewDropdown("„ÉªSelect Player Target", "Choose a player to lock onto", PlayerList, function(selected)
    if selected == "None" then
        SilentAimModule:SetSelectedPlayer(nil)
    else
        SilentAimModule:SetSelectedPlayer(selected)
    end
end)

local function RefreshPlayerList()
    local newList = {"None"}
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= Players.LocalPlayer then
            table.insert(newList, plr.Name)
        end
    end
    PlayerDropdown:Refresh(newList, true)
end

Players.PlayerAdded:Connect(RefreshPlayerList)
Players.PlayerRemoving:Connect(RefreshPlayerList)
RefreshPlayerList()

local ZSkillToggle = Section:NewToggle("„ÉªGodhumanZ Aimlock", "I only set Godhuman", function(state)
    ZSkillModule:SetZSkills(state)
    Settings["ZSkills"] = state
end)

local HighlightToggle = Section:NewToggle("„ÉªMain Highlight", "Current Target Highlighted", function(state)
    SilentAimModule:SetHighlight(state)
    Settings["Highlight"] = state
end)

local ZskillMOneToggle = Section:NewToggle("„ÉªZ|M1 Skills(except Godhuman Z)", "Silent Aim That Work Some Skills", function(state)
    SilentAimModule:SetZSkillorM1(state)
    Settings["Zskillmone"] = state
end)

local Tab = Window:NewTab("‚úø„ÉªFeatures")
local Section = Tab:NewSection("‚öú„ÉªSettings")

Section:NewButton("Join Discord", "Get Link Discord server", function()
	local link = "https://discord.gg/fKwqmB4C"
    if setclipboard then
        setclipboard(link)
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Sapi Hub",
            Text = "Copied Discord Link!",
            Duration = 5
        })
    end
end)

local ESPPlayersToggle = Section:NewToggle("„ÉªESP Players", "Toggle Player ESP", function(state)
    ESPModule:SetESP(state)
    Settings["ESPPlayers"] = state
end)

local V3SkillToggle = Section:NewToggle("„ÉªV3 Skill", "Auto activate V3 ability", function(state)
    ESPModule:SetV3(state)
    Settings["V3Skill"] = state
end)

local BunnyHopToggle = Section:NewToggle("„ÉªBunny hop", "Toggle Bunnyhop", function(state)
    ESPModule:SetBunnyhop(state)
    Settings["BunnyHop"] = state
end)

local AuraSkillToggle = Section:NewToggle("„ÉªAura Skill", "Auto activate Buso", function(state)
    ESPModule:SetBuso(state)
    Settings["AuraSkill"] = state
end)

local FpsOrPingsToggle = Section:NewToggle("„ÉªFps Or Pings", "Display Ping or Fps", function(state)
    StuffsModule:SetPingsOrFps(state)
    Settings["FpsOrPings"] = state
end)

Section:NewTextBox("Speed Hack", "WalkSpeedValue", function(speedfunc)
    local num = tonumber(speedfunc)
    if num then
        getgenv().WalkSpeedValue = num
        UiSettingsModule:SetWalkSpeed(num)
    end
end)

local FpsBoostToggle = Section:NewToggle("„ÉªFps Boost", "Increase Fps", function(state)
    StuffsModule:SetFpsBoost(state)
    Settings["FpsBoost"] = state
end)

local INFEnergyToggle = Section:NewToggle("„ÉªINF Energy", "Max Energy", function(state)
    StuffsModule:SetINFEnergy(state)
    Settings["INFEnergy"] = state
end)

local WalkonWaterToggle = Section:NewToggle("„ÉªWalk on Water", "Travel in Water", function(state)
    StuffsModule:SetWalkWater(state)
    Settings["WalkonWater"] = state
end)

local FastAttackToggle = Section:NewToggle("„ÉªFast Attack", "Fast Attack", function(state)
    StuffsModule:SetFastAttack(state)
    Settings["FastAttack"] = state
end)

local AntiAFKToggle = Section:NewToggle("„ÉªAntiAfk", "AntiAfk only on before you off", function(state)
    ESPModule:SetAntiAfk(state)
    Settings["AntiAFK"] = state
end)

Section:NewTextBox("Jump Power", "JumpValue", function(jumpfunc)
  getgenv().JumpValue = jumpfunc
    if getgenv().JumpValue then
        game:GetService("Players").LocalPlayer.Character.Humanoid.JumpPower = getgenv().JumpValue
    end
end)

local V4Toggle = Section:NewToggle("„ÉªAuto V4", "Auto V4 Transform", function(state)
    UiSettingsModule:SetV4(state)
    Settings["V4"] = state
end)

local FruitCheckToggle = Section:NewToggle("„ÉªSpawned Fruit Check", "Check Fruit Spawned", function(state)
    UiSettingsModule:SetFruitCheck(state)
    Settings["FruitCheck"] = state
end)

local TeleportFruitToggle = Section:NewToggle("„ÉªBring Fruits", "It take few seconds to bring fruits", function(state)
    UiSettingsModule:SetTeleportFruit(state)
    Settings["TeleportFruit"] = state
end)

local AutoKenToggle = Section:NewToggle("„ÉªAuto Ken", " AutoKen", function(state)
    SilentAimModule:SetAutoKen(state)
    Settings["AutoKen"] = state
end)

local LavaToggle = Section:NewToggle("„ÉªRemove Lava", "Remove Lava", function(state)
    StuffsModule:SetLava(state)
    Settings["Lava"] = state
end)

local FogToggle = Section:NewToggle("„ÉªRemove Fog", "Remove Fog", function(state)
    StuffsModule:SetFog(state)
    Settings["Fog"] = state
end)

local DodgeToggle = Section:NewToggle("„ÉªDodge no cd", "Dodge no cd", function(state)
    ESPModule:SetNoDodgeCD(state)
    Settings["Dodge"] = state
end)

local OpponentToggle = Section:NewToggle("„ÉªTarget Info(Name/Health)", "Info Of Target", function(state)
    ZSkillModule:SetInfo(state)
    Settings["Opponent"] = state
end)

local Tab = Window:NewTab("‚öô„ÉªSettings Manager")
local Section = Tab:NewSection("üíæ„ÉªSettings")

Section:NewTextBox("Paste Job Id Here", "Paste JobId and press Enter", function(jobid)
    if jobid and jobid ~= "" then
        TeleportService:TeleportToPlaceInstance(game.PlaceId, jobid, Players.LocalPlayer)
    end
end)

Section:NewButton("Save Current Settings", "Save all current settings", function()
    OthersStuffsModule.SaveSettings(Settings)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Sapi Hub",
        Text = "Settings Saved!",
        Duration = 4
    })
end)

Section:NewButton("Reset Settings", "Clear saved settings", function()
    OthersStuffsModule.ResetSettings()
    Settings = {} -- also clear local
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Sapi Hub",
        Text = "Settings Reset!",
        Duration = 4
    })
end)

Section:NewButton("Rejoin Server", "Rejoin your server", function()
    StuffsModule:SetRejoinServer()
end)

local GlobalTextDropdown = Section:NewDropdown("„ÉªGlobal Text Font", "Change font for all text", {
    "Arcade",
    "Cartoon",
    "SciFi",
    "Fantasy",
    "Antique",
    "Garamond",
    "RobotoMono",
    "FredokaOne",
    "LuckiestGuy",
    "PermanentMarker",
    "SpecialElite",
    "Oswald",
    "Nunito"
}, function(selected)
    local fontEnum = Enum.Font[selected]
    if fontEnum then
        ESPModule:SetGlobalFont(fontEnum)
        Settings["GlobalFont"] = selected
    else
        warn("Font not found:", selected)
    end
end)

local RTXModeDropdown = Section:NewDropdown("„ÉªRTX Graphics Mode", "Choose between Autumn or Summer lighting", {"Autumn", "Summer", "Spring", "Winter"}, function(selected)
    ESPModule:SetRTXMode(selected)
    Settings["RTXMode"] = selected
end)

local ThemesDropdown = Section:NewDropdown("Select Theme", "Choose a color theme", UiSettingsModule:getThemeNames(), function(selected)
    local newColor = UiSettingsModule.themes[selected]
    if newColor then
        UiSettingsModule:updateSchemeColor(newColor, Library)
        Settings["Themes"] = selected
    end
end)

local BackgroundThemesDropdown = Section:NewDropdown("Select Background Theme", "Choose a color background", UiSettingsModule:getBackgroundThemeNames(), function(selected)
    local newColor = UiSettingsModule.backgroundThemes[selected]
    if newColor then
        UiSettingsModule:updateBackgroundColor(newColor, Library)
        Settings["BackgroundThemes"] = selected
    end
end)

local TextColorDropdown = Section:NewDropdown("Select TextColor", "Choose a textcolor", UiSettingsModule:getThemeNames(), function(selected)
    local newColor = UiSettingsModule.themes[selected]
    if newColor then
        UiSettingsModule:updateTextColor(newColor, Library)
        Settings["TextColor"] = selected
    end
end)

Settings = OthersStuffsModule.LoadSettings()

OthersStuffsModule:ApplySettings(Settings, {
    Aimlock = AimlockModule,
    SilentAim = SilentAimModule,
    ESP = ESPModule,
    Stuffs = StuffsModule,
    Ui = UiSettingsModule,
    Zskill= ZSkillModule
}, {
    AimlockPlayers = AimlockPlayersToggle,
    AimlockPlayersMiniTogglePlayers = AimlockPlayersMiniTogglePlayersToggle,
    AimlockNPC = AimlockNPCToggle,
    SilentAimPlayers = SilentAimPlayersToggle,
    SilentAimNPC = SilentAimNPCToggle,
    ESPPlayers = ESPPlayersToggle,
    AntiAFK = AntiAFKToggle,
    FpsOrPings = FpsOrPingsToggle,
    FpsBoost = FpsBoostToggle,
    INFEnergy = INFEnergyToggle,
    FastAttack = FastAttackToggle,
    WalkonWater = WalkonWaterToggle,
    V4 = V4Toggle,
    FruitCheck = FruitCheckToggle,
    TeleportFruit = TeleportFruitToggle,
    AutoKen = AutoKenToggle,
    ZSkills = ZSkillToggle,
    BunnyHop = BunnyHopToggle,
    AuraSkill = AuraSkillToggle,
    V3Skill = V3SkillToggle,
    Highlight = HighlightToggle,
    SilentMiniToggleNPC = SilentMiniToggleNPCToggle,
    SilentMiniTogglePlayers = SilentMiniTogglePlayersToggle,
    Zskillmone = ZskillMOneToggle,
    SilentAimPediction = SilentAimPedictionToggle,
    Dodge = DodgeToggle,
    Lava = LavaToggle,
    Fog = FogToggle,
    PredictionAmount = PredictionAimlockAmountDropdown,
    SilentAimPredictionFuture = PredictionAmountDropdown,
    SilentAimDistanceLimit = DistanceAmountDropdown,
    GlobalFont = GlobalTextDropdown,
    RTXMode = RTXModeDropdown,
    Themes = ThemesDropdown,
    BackgroundThemes = BackgroundThemesDropdown,
    TextColor = TextColorDropdown
})

OthersStuffsModule.StartFruitNotifier()

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.M then
        Library:ToggleUI()
		toggleButton.Visible = not toggleButton.Visible
    end
end)

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and UserInputService.KeyboardEnabled and input.KeyCode == Enum.KeyCode.G then

        Settings["SilentAimPlayers"] = not Settings["SilentAimPlayers"]
        SilentAimModule:SetPlayerSilentAim(Settings["SilentAimPlayers"])
        if SilentAimPlayersToggle then
            SilentAimPlayersToggle:UpdateToggle(Settings["SilentAimPlayers"])
        end
    end
end)

toggleButton.MouseButton1Click:Connect(function()
    Library:ToggleUI()
end)
